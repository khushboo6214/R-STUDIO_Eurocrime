---
title: "Assignment 1"
author: "Khusboo Satpute"
date: "09/10/2019"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Task 1: Manipulation
## 1.Load the dataset EurostatCrime2017.csv
```{r loadDataSet}
df=read.csv(
  '/Users/dastan/Desktop/EurostatCrime2017.csv',
  stringsAsFactors = FALSE,row.names = 1)

```

## 2. Size & structure of this dataset
```{r Dataset Size and Structure}
nrow(df)
ncol(df)
str(df)
```

## 3. Produce appropriate commands to answer the following questions:
## 3.1 Add a new column called All Theft
```{r All_Theft}
Ncol=c("Burglary", "Theft", "Theft_of_a_motorized_land_vehicle", "Burglary_of_private_residential_premises")
df$Burglary[is.na(df$Burglary)] <- 0
df$Burglary_of_private_residential_premises[is.na(df$Burglary_of_private_residential_premises)]<- 0
df$Theft<-0
df$Theft_of_a_motorized_land_vehicle<-0

df$Alltheft<-rowSums(df[ ,Ncol])

df$Alltheft
```

## 3.2 Remove the other columns
```{r Remove Other Theft Columns}
df<- subset(df,select = -c(Burglary,Theft,
                         Theft_of_a_motorized_land_vehicle,
                         Burglary_of_private_residential_premises))
```

## 4. List the countries that contain any missing data
```{r Non NA countries}
country<-list()
for(i in 1:nrow(df)) 
{ 
 if(any(is.na(df[i,])))
 {
  country<- c(country,rownames(df[i,]))
 }
}

print(country)
```

## 5. Remove the countries with missing data from the dataframe.
```{r Omit NA}
df <- na.omit(df)
```

## 6.How many observations and variables are in this new dataframe?
```{r Updated Dataset}
dim(df)
```

# Task 2: Analysis
## 1.The 3 most common crimes in Ireland in 2017?
```{r Ireland_TOPCRIME}
ireland_df<-subset(df,rownames(df)=="Ireland")
top_crime <- colnames(sort(ireland_df, decreasing = TRUE)[1:3])
top_crime
```

## 2.Which country has the highest overall record of offences
```{r Highest_Overall}
df$offence<-apply(df,1,sum)
H_offence<- rownames(df[which.max(df$offence),])
H_offence
```

# Task 3: Creativity
```{r plot}
library(ggplot2)
crimes <- c(df$Intentional_homicide, df$Attempted_intentional_homicide)
countries <- rownames(df)
types <- c(rep("Intentional Homicide", length(df$Intentional_homicide)), 
           rep("Attempted Homicide", length(df$Attempted_intentional_homicide)))
plot_data <- data.frame(countries, crimes, types)
plt <- ggplot(plot_data, aes(countries, crimes))
plt + geom_bar(stat = 'identity', aes(fill = types)) +
  xlab("Countries") + ylab("Crime Count") + theme_bw()
```  

The Plot describe the crimecount for Homicide (Attempted Homicide and Intentional Homicide )for various countries in Euro states. The Graph has X label as Countries and Y label Crime Count from the graph. Also, we can infer the total homicide in a particular country as well as we can also observe that attempted Homicide cases are more in every country indicated by red block than Intentional Homicide indicated by green in color.
