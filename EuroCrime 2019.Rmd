---
title: "EuroStat Crime Analysis"
author: "Khusboo Satpute"
date: "09/10/2019"
output: pdf_document
---
## EUROCRIME STAT ANALYSIS
The dataset EurostatCrime2017.csv records oences (values per hundred thousand in-
habitants) by oence category in 41 European Countries in 2017. Full information on the
dataset is available here: https://ec.europa.eu/eurostat/cache/metadata/en/crim_off_
cat_esms.htm.
 Complete your assignment using R Markdown, check that all the output and code are
correctly shown in your nal document. Knit your document frequently to x errors.
Once completed, submit the Rmd le and the resulting pdf or word document which
shows all your code.

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Task 1: Manipulation
## 1.Load the dataset EurostatCrime2017.csv. Notice that the rst column of the csv le
contains the names of the countries that must be read as row names 
2. What is the size (number of rows and columns) and the structure of this dataset?
3. Produce appropriate commands to answer the following questions:
(i) For some countries Theft includes also burglary, and theft of motorised land vehicle,
in others they are recorded separately. Add a new column called All Theft which
contains the sum of all the crimes that have a theft component:
 Theft,
 Theft of a motorized land vehicle,
 Burglary,
 Burglary of private residential premises
Please consider NA values as 0 in this case. 
(ii) Remove the columns: Theft, Theft of a motorized land vehicle, Burglary, and
Burglary of private residential premises.
```{r loadDataSet}
df=read.csv("EurostatCrime2017.csv",  stringsAsFactors = FALSE,row.names = 1)

```

## 2. Size & structure of this dataset
```{r Dataset Size and Structure}
nrow(df)
ncol(df)
str(df)
```

## 3. Produce appropriate commands to answer the following questions:
## 3.1 Add a new column called All Theft
```{r All_Theft}
Ncol=c("Burglary", "Theft", "Theft_of_a_motorized_land_vehicle", "Burglary_of_private_residential_premises")
df$Burglary[is.na(df$Burglary)] <- 0
df$Burglary_of_private_residential_premises[is.na(df$Burglary_of_private_residential_premises)]<- 0
df$Theft<-0
df$Theft_of_a_motorized_land_vehicle<-0

df$Alltheft<-rowSums(df[ ,Ncol])

df$Alltheft
```

## 3.2 Remove the other columns
```{r Remove Other Theft Columns}
df<- subset(df,select = -c(Burglary,Theft,
                         Theft_of_a_motorized_land_vehicle,
                         Burglary_of_private_residential_premises))
```

## 4. List the countries that contain any missing data
```{r Non NA countries}
country<-list()
for(i in 1:nrow(df)) 
{ 
 if(any(is.na(df[i,])))
 {
  country<- c(country,rownames(df[i,]))
 }
}

print(country)
```

## 5. Remove the countries with missing data from the dataframe.
```{r Omit NA}
df <- na.omit(df)
```

## 6.How many observations and variables are in this new dataframe?
```{r Updated Dataset}
dim(df)
```

# Task 2: Analysis
## 1.The 3 most common crimes in Ireland in 2017?
```{r Ireland_TOPCRIME}
ireland_df<-subset(df,rownames(df)=="Ireland")
top_crime <- colnames(sort(ireland_df, decreasing = TRUE)[1:3])
top_crime
```

## 2.Which country has the highest overall record of offences
```{r Highest_Overall}
df$offence<-apply(df,1,sum)
H_offence<- rownames(df[which.max(df$offence),])
H_offence
```

# Task 3: Creativity
```{r plot}
library(ggplot2)
crimes <- c(df$Intentional_homicide, df$Attempted_intentional_homicide)
countries <- rownames(df)
types <- c(rep("Intentional Homicide", length(df$Intentional_homicide)), 
           rep("Attempted Homicide", length(df$Attempted_intentional_homicide)))
plot_data <- data.frame(countries, crimes, types)
plt <- ggplot(plot_data, aes(countries, crimes))
plt + geom_bar(stat = 'identity', aes(fill = types)) +
  xlab("Countries") + ylab("Crime Count") + theme_bw()
```  

The Plot describe the crimecount for Homicide (Attempted Homicide and Intentional Homicide )for various countries in Euro states. The Graph has X label as Countries and Y label Crime Count from the graph. Also, we can infer the total homicide in a particular country as well as we can also observe that attempted Homicide cases are more in every country indicated by red block than Intentional Homicide indicated by green in color.
